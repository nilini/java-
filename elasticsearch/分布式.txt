1、路由一个文档到一个分片中
    确定主分片：shard = hash(routing) % number_of_primary_shards
    routing是一个可变值，默认是文档的_id。
2、主分片和副分片如何交互
    可以发送请求到集群中的任一节点，每个节点都有能力处理任意请求，每个节点都知道集群中任一文档位置，所以可以直接将请求转发到需要的节点上。
3、新建、索引和删除单个文档
    https://www.elastic.co/guide/cn/elasticsearch/guide/current/distrib-write.html
    以下是在主副分片和任何副本分片上面 成功新建，索引和删除文档所需要的步骤顺序：
    1）客户端向 Node 1 发送新建、索引或者删除请求。
    2）节点使用文档的 _id 确定文档属于分片 0 。请求会被转发到 Node 3`，因为分片 0 的主分片目前被分配在 `Node 3 上。
    3）Node 3 在主分片上面执行请求。如果成功了，它将请求并行转发到 Node 1 和 Node 2 的副本分片上。一旦所有的副本分片都报告成功, Node 3 将向协调节点报告成功，协调节点向客户端报告成功。
    在客户端收到成功响应时，文档变更已经在主分片和所有副本分片执行完成，变更是安全的。
4、取回单个文档
    在处理读取请求时，协调结点在每次请求的时候都会通过轮询所有的副本分片来达到负载均衡。